---
title: Server GIS e cartografici
day: 1
---

Lezione 6
=========
<iframe width="100%" height="400" src="//jsfiddle.net/gis3w/ekL4edxd/embedded/result,html,js,css" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

``` javascript
var sourceFeatures = new ol.source.Vector(),
    layerFeatures = new ol.layer.Vector({
        source: sourceFeatures
    })
;

var lineString = new ol.geom.LineString([]);

var layerRoute =  new ol.layer.Vector({
    source: new ol.source.Vector({
        features: [
            new ol.Feature({ geometry: lineString })
        ]
    }),
    style: [
        new ol.style.Style({
            stroke: new ol.style.Stroke({
                width: 3, color: 'rgba(0, 0, 0, 1)',
                lineDash: [.1, 5]
            }),
            zIndex: 2
        })
    ],
    updateWhileAnimating: true
});


var map = new ol.Map({
    target: 'map',
    view: new ol.View({
        center: [-5483805.05,-1884105.39],
        zoom: 16,
        minZoom: 2,
        maxZoom: 20
    }),
    layers: [
      new ol.layer.Tile({ 
          source: new ol.source.OSM(),
          opacity: 0.6
      }),
      layerRoute, layerFeatures
    ]
});

var markerEl = document.getElementById('geo-marker');
var marker = new ol.Overlay({
    positioning: 'center-center',
    offset: [0, 0],
    element: markerEl,
    stopEvent: false
});
map.addOverlay(marker);

var 
	fill = new ol.style.Fill({color:'rgba(255,255,255,1)'}),
    stroke = new ol.style.Stroke({color:'rgba(0,0,0,1)'}),
    style1 = [
        new ol.style.Style({
            image: new ol.style.Icon(({
                scale: .7, opacity: 1,
                rotateWithView: false, anchor: [0.5, 1],
                anchorXUnits: 'fraction', anchorYUnits: 'fraction',
                src: '//cdn.rawgit.com/jonataswalker/map-utils/' + 						'master/images/marker.png'
            })),
            zIndex: 5
        }),
        new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6, fill: fill, stroke: stroke
            }),
            zIndex: 4
        })
    ]
;


//a simulated path
var path = [
    [-5484116.753984261,-1884416.14606312],
    [-5484122.765236764,-1884331.5428025876],
    [-5484104.954118238,-1884303.7679013235],
    [-5484051.409443166,-1884282.2685246097],
    [-5483805.05941004,-1884105.3933610613],
    [-5483669.249631273,-1884063.0922822598],
    [-5483599.118352073,-1883979.3038447134],
    [-5483475.553717293,-1883769.6598181103]
];


var
	feature_start = new ol.Feature({
        geometry: new ol.geom.Point(path[0])
    }),
    feature_end = new ol.Feature({
        geometry: new ol.geom.Point(path[path.length - 1])
    })
;
feature_start.setStyle(style1);
feature_end.setStyle(style1);
sourceFeatures.addFeatures([feature_start, feature_end]);

lineString.setCoordinates(path);

//fire the animation
map.once('postcompose', function(event) {
    interval = setInterval(animation, 500);
});

var i = 0, interval;
var animation = function(){
    
    if(i == path.length){
        i = 0;
    }

    marker.setPosition(path[i]);
    i++;
};
```